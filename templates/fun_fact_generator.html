{% extends 'base.html' %}

{% block title %}Fun Fact Generator{% endblock %}

{% block content %}
<h2 id="fun-fact-title">Fun Fact Generator</h2>
<div class="fun-fact-container">
    <h2 id="fun-fact-title">Did You Know?</h2>
    <label for="num-facts-input">Number of Fun Facts:</label>
    <input type="number" id="num-facts-input" value="3" min="1" max="10">
    <button id="get-fun-fact-btn">Get Fun Facts</button>
    <div id="fun-fact-text-container"><b></b></div>
</div>
<a href="{{ url_for('home') }}" class="home-btn">Home</a>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const getFunFactButton = document.getElementById('get-fun-fact-btn');
        const funFactTitle = document.getElementById('fun-fact-title');
        const funFactContainer = document.getElementById('fun-fact-text-container');
        const numFactsInput = document.getElementById('num-facts-input');

        const getFunFacts = async () => {
            try {
                const numFacts = numFactsInput.value || 1; // Default to 1 if input is empty
                const response = await fetch(`/api/fun-facts?num_facts=${numFacts}`);
                const data = await response.json();

                if (data && data.fun_facts) {
                    // Clear previous content
                    funFactContainer.innerHTML = '';

                    // Display each fun fact on a new line
                    data.fun_facts.forEach(fact => {
                        const factParagraph = document.createElement('p');
                        factParagraph.textContent = fact;
                        funFactContainer.appendChild(factParagraph);
                    });
                } else {
                    console.error('Invalid or empty response:', data);
                }
            } catch (error) {
                console.error('Error fetching fun facts:', error);
            }
        };

        // Attach the function to the button click event
        if (getFunFactButton) {
            getFunFactButton.addEventListener('click', getFunFacts);
        } else {
            console.error('Missing element with ID: get-fun-fact-btn');
        }

        // Initial fetch when the page loads
        getFunFacts();

        // Set interval for automatic update (e.g., every 10 seconds)
        setInterval(getFunFacts, 10000); // 10000 milliseconds = 10 seconds
    });
</script>
{% endblock %}
