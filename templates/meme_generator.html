{% extends 'base.html' %}

{% block title %}Meme Generator{% endblock %}

{% block content %}
    <h2 id="fun-fact-title">Meme Generator</h2>

    <!-- Table structure with left and right text and meme image in the center -->
    <table style="border: 0; width: 100%;">
        <tr>
            <td class="meme-quote"style="text-align: center;">"Memes are a way to express oneself, and computer science memes are a way for programmers to express their love for coding, technology, and the occasional bug."
            <br><br>
            </td>
            <td style="text-align: center;">
                <!-- Display the randomly selected meme -->
                <div class="meme-container" id="meme-container">
                    <img src="{{ meme['src'] }}" alt="Random Meme" class="meme-image">
                </div>
            </td>
            <td class="meme-quote"style="text-align: center;"> "Computer science memes are the ultimate form of geek humor. They're a way to celebrate the quirks and eccentricities of programming, and to revel in the joy of solving complex problems."</td>
        </tr>
    </table>

    <div class="button-container">
        <button id="prev-meme-btn">Previous Meme</button>
        <button id="get-meme-btn">Next Meme</button>
    </div>


    <a href="{{ url_for('home_page') }}" class="home-btn">Home</a>

    <!-- Add other content or buttons as needed -->

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let prevMemeUrl = '';
    
            // Function to fetch a new meme from the server
            function getNewMeme() {
                fetch('/meme-generator')
                    .then(response => response.text())  // Use response.text() for HTML content
                    .then(data => {
                        const container = document.createElement('div');
                        container.innerHTML = data;
    
                        const memeContainer = document.getElementById('meme-container');
                        const newMeme = container.querySelector('.meme-container');
    
                        // Store the previous meme's URL before updating it
                        prevMemeUrl = memeContainer.querySelector('img').src;
    
                        // Update the 'meme-container' with the new meme HTML
                        memeContainer.innerHTML = newMeme.innerHTML;
                    })
                    .catch(error => console.error('Error fetching meme:', error));
            }
    
            // Attach the function to the button click event
            const getMemeButton = document.getElementById('get-meme-btn');
            getMemeButton.addEventListener('click', getNewMeme);
            getMemeButton.addEventListener('keydown', function(event) {
                if (event.key === 'Enter' || event.key === ' ') {
                    getNewMeme();
                }
            });
    
            // Attach click event to home button
            const homeButton = document.querySelector('.home-btn');
            homeButton.addEventListener('click', function () {
                window.location.href = "/";
            });
    
            // Function to go back to the previous meme
            function goToPrevMeme() {
                if (prevMemeUrl) {
                    const memeContainer = document.getElementById('meme-container');
                    memeContainer.innerHTML = `<img src="${prevMemeUrl}" alt="Previous Meme" class="meme-image">`;
                } else {
                    console.log('No previous meme available');
                }
            }
    
            // Attach the function to the button click event
            const prevMemeButton = document.getElementById('prev-meme-btn');
            prevMemeButton.addEventListener('click', goToPrevMeme);
            prevMemeButton.addEventListener('keydown', function(event) {
                if (event.key === 'Enter' || event.key === ' ') {
                    goToPrevMeme();
                }
            });
    
            // Initial fetch when the page loads
            getNewMeme();
            // Set interval for automatic update (e.g., every 15 seconds)
            setInterval(getNewMeme, 15000); // 15000 milliseconds = 15 seconds
        });
    </script>
    
{% endblock %}
